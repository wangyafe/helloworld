<!-- 查询条件 -->
<sql id="lawcase_consult_where_clause">
		<where>
			del_flag = 0
			<if test="consultId != null and  consultId != ''"> and consult_id= #{consultId}</if>
			<if test="consultor != null and  consultor != ''"> and consultor= #{consultor}</if>
			<if test="consultContent != null and  consultContent != ''"> and consult_content= #{consultContent}</if>
			<if test="contact != null and  contact != ''"> and contact= #{contact}</if>
			<if test="startTime != null and  startTime != ''">and create_time >= #{startTime,jdbcType=VARCHAR}</if>
			<if test="endTime != null and  endTime != ''">and  DATE_ADD(date_format(#{endTime,jdbcType=VARCHAR},"%Y-%m-%d"),interval 1 day) >=create_time</if>
			<if test="search != null and  search != ''"> 
			 <bind name="pattern" value="search" />
			and concat(consultor,consult_content,contact) like concat('%',#{pattern},'%') escape'/'
			</if>
		</where>
	</sql>
	
	logging.level.com=DEBUG：com包下所有class以DEBUG级别输出
 //绑定隐私号码
        List<String> codes = Arrays.asList(areaCodes.split(","));
        //打乱顺序
        Collections.shuffle(codes);
        AxbBindRequest axbBindRequest=null;
        BindResponse bindResponse=null;
        // 多次尝试直至成功
        for (String areaCode:codes) {
            axbBindRequest = AxbBindRequestUtils.toAxbBindRequest(clue, lawyer, areaCode, expireTimeSecond);
            log.info("pns请求参数：" + JSON.toJSONString(axbBindRequest));
            bindResponse = pnsClientService.sendAxbBindRequest(axbBindRequest);
            log.info("pns响应参数：" + JSON.toJSONString(bindResponse));
            if (PNS_CODE_SUCCESS.equals(bindResponse.getCode())) {
                break;
            }
        }
<mapper namespace="global">

	<!-- 分页：oracle -->
	<sql id="paginationStart_oracle">
		<![CDATA[ select * from (select row_.*, rownum rownum_ from ( ]]>
	</sql>
	<sql id="paginationEnd_oracle">
		<![CDATA[ ) row_ where rownum <= #{end}) where rownum_ > #{start} ]]>
	</sql>

	<!-- 分页：sql server -->
	<sql id="paginationStart_mssql">
		<![CDATA[ select top ${rows} * from (select ROW_NUMBER() over( order by getdate() asc) as rownum, * from ( ]]>
	</sql>
	<sql id="paginationEnd_mssql">
		<![CDATA[ ) b ) a where a.rownum > #{start}  ]]>
	</sql>

	<!-- 分页：mysql -->
	<sql id="paginationStart_mysql">
		<![CDATA[ select * from ( ]]>
	</sql>
	<sql id="paginationEnd_mysql">
		<bind name="key_page" value="(page-1)*pageSize"></bind>
		<if test="page &lt;= 0 ">
			<![CDATA[ ) row_ limit 0, #{pageSize} ]]>
		</if>
		<if test="page > 0 "> 
			<![CDATA[ ) row_ limit  #{key_page}, #{pageSize} ]]>
		</if>
	</sql>
	
	<!-- 排序 -->
	<sql id="orderBy">
		<if test="sort!=null">
			<![CDATA[ ORDER BY ${sort} ${dir} ]]>
		</if>
	</sql>

</mapper>
  /**
     * 获取不需要Token验证的path列表
     */
    private List<String> findExcludePath() {
        // 获取有添加RestController的Bean
        Map<String, Object> controllerBeanMap = applicationContext.getBeansWithAnnotation(RequestMapping.class);
        Set<String> excludePath = new HashSet<>();
        try {
            for (Object controller : controllerBeanMap.values()) {
                Class<?> controllerClass = controller.getClass();
                Permission classPermission = AnnotationUtils.findAnnotation(controllerClass,Permission.class);
                RequestMapping controllerMapping = AnnotationUtils.findAnnotation(controllerClass,RequestMapping.class);
                // 获取url的前缀
                String prefixValue = "";
                if (controllerMapping != null) {
                    prefixValue = controllerMapping.value()[0];
                }
                Method[] controllerMethods = controllerClass.getMethods();
                for (Method method : controllerMethods) {
                    Permission methodPermission = AnnotationUtils.findAnnotation(method,Permission.class);
                    RequestMapping requestMapping = AnnotationUtils.findAnnotation(method,RequestMapping.class);
                    // 类注解排除所有request路径，方法注解排除本方法路径
                    if ((classPermission!=null||methodPermission != null) && requestMapping !=null) {
                        String path = requestMapping.value()[0];
                        excludePath.add(prefixValue+path);
                    }
                }
            }
        } catch (Exception e) {
            log.error("拦截器exclude path异常:", e);
        }
        return new ArrayList<>(excludePath);
    }
  获取方法的正确姿势：Method[] methods = ReflectionUtils.getAllDeclaredMethods(AopUtils.getTargetClass(bean));
  错误姿势：Method[] methods = ReflectionUtils.getAllDeclaredMethods(bean.getClass());
  使用泛型
  public interface MessageProcessor<T> {
    boolean handleMessage(T messageExt);
   
    Class<T> getClazz();

    default T transferMessage(String message) {
        return JSON.parseObject(message, getClazz());
    }
}
public class Test implement Message<Entity>{}

 判断对象每一个属性是否为空（反射）
  /**
     * 判断对象是否为空，且对象的所有属性都为空
     * ps: boolean类型会有默认值false 判断结果不会为null 会影响判断结果
     *     序列化的默认值也会影响判断结果
     * @param object
     * @return
     */
    public  boolean objCheckIsNull(Object object){
        Class clazz = (Class)object.getClass(); // 得到类对象
        Field fields[] = clazz.getDeclaredFields(); // 得到所有属性
        boolean flag = true; //定义返回结果，默认为true
        for(Field field : fields){
            field.setAccessible(true);
            Object fieldValue = null;
            try {
                fieldValue = field.get(object); //得到属性值
                Type fieldType =field.getGenericType();//得到属性类型
                String fieldName = field.getName(); // 得到属性名
                System.out.println("属性类型："+fieldType+",属性名："+fieldName+",属性值："+fieldValue);
            } catch (IllegalArgumentException e) {
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            }
            if(fieldValue != null){  //只要有一个属性值不为null 就返回false 表示对象不为null
                flag = false;
                break;
            }
        }
        return flag;
    }
    
}
