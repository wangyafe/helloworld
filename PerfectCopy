<!-- 查询条件 -->
<sql id="lawcase_consult_where_clause">
		<where>
			del_flag = 0
			<if test="consultId != null and  consultId != ''"> and consult_id= #{consultId}</if>
			<if test="consultor != null and  consultor != ''"> and consultor= #{consultor}</if>
			<if test="consultContent != null and  consultContent != ''"> and consult_content= #{consultContent}</if>
			<if test="contact != null and  contact != ''"> and contact= #{contact}</if>
			<if test="startTime != null and  startTime != ''">and create_time >= #{startTime,jdbcType=VARCHAR}</if>
			<if test="endTime != null and  endTime != ''">and  DATE_ADD(date_format(#{endTime,jdbcType=VARCHAR},"%Y-%m-%d"),interval 1 day) >=create_time</if>
			<if test="search != null and  search != ''"> 
			 <bind name="pattern" value="search" />
			and concat(consultor,consult_content,contact) like concat('%',#{pattern},'%') escape'/'
			</if>
		</where>
	</sql>
	
	logging.level.com.didispace=DEBUG：com.didispace包下所有class以DEBUG级别输出
 //绑定隐私号码
        List<String> codes = Arrays.asList(areaCodes.split(","));
        //打乱顺序
        Collections.shuffle(codes);
        AxbBindRequest axbBindRequest=null;
        BindResponse bindResponse=null;
        // 多次尝试直至成功
        for (String areaCode:codes) {
            axbBindRequest = AxbBindRequestUtils.toAxbBindRequest(clue, lawyer, areaCode, expireTimeSecond);
            log.info("pns请求参数：" + JSON.toJSONString(axbBindRequest));
            bindResponse = pnsClientService.sendAxbBindRequest(axbBindRequest);
            log.info("pns响应参数：" + JSON.toJSONString(bindResponse));
            if (PNS_CODE_SUCCESS.equals(bindResponse.getCode())) {
                break;
            }
        }
<mapper namespace="global">

	<!-- 分页：oracle -->
	<sql id="paginationStart_oracle">
		<![CDATA[ select * from (select row_.*, rownum rownum_ from ( ]]>
	</sql>
	<sql id="paginationEnd_oracle">
		<![CDATA[ ) row_ where rownum <= #{end}) where rownum_ > #{start} ]]>
	</sql>

	<!-- 分页：sql server -->
	<sql id="paginationStart_mssql">
		<![CDATA[ select top ${rows} * from (select ROW_NUMBER() over( order by getdate() asc) as rownum, * from ( ]]>
	</sql>
	<sql id="paginationEnd_mssql">
		<![CDATA[ ) b ) a where a.rownum > #{start}  ]]>
	</sql>

	<!-- 分页：mysql -->
	<sql id="paginationStart_mysql">
		<![CDATA[ select * from ( ]]>
	</sql>
	<sql id="paginationEnd_mysql">
		<bind name="key_page" value="(page-1)*pageSize"></bind>
		<if test="page &lt;= 0 ">
			<![CDATA[ ) row_ limit 0, #{pageSize} ]]>
		</if>
		<if test="page > 0 "> 
			<![CDATA[ ) row_ limit  #{key_page}, #{pageSize} ]]>
		</if>
	</sql>
	
	<!-- 排序 -->
	<sql id="orderBy">
		<if test="sort!=null">
			<![CDATA[ ORDER BY ${sort} ${dir} ]]>
		</if>
	</sql>

</mapper>
